<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
        <link rel="stylesheet" type="text/css" href="/css/style.css" />
        <link rel="alternate" type="application/rss+xml" title="m4.rkw.io blog" href="http://m4.rkw.io/blog/rss" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script src='https://www.google.com/recaptcha/api.js'></script>
        <script src="/js/site.js"></script>
        <title>Mark Wadham</title>
    </head>
    <body>
        <div id="menu">
                        <h3>Mark Wadham</h3>
            <ul>
                <li><a href="/">profile</a></li>
                <li><a href="/blog.html">blog</a> <a href="/blog/rss"><img src="/img/rss.png" /></a></li>
                <li><a href="/cves.html">CVEs</a></li>
                <li><a href="/jsdemos.html">js demos</a></li>
                <li><a href="/contact.html">contact</a></li>
                <li class="space small">twitter: <a href="https://twitter.com/m4rkw">m4rkw</a></li>
                <li class="small">github: <a href="https://github.com/m4rkw">m4rkw</a></li>
                <li class="small">linkedin: <a href="https://uk.linkedin.com/in/mark-wadham-14ab49a6">379069834</a></li>
                <li class="red space small"></li>
            </ul>
        </div>
        <div id="content">
            <div id="main-content">
                            
                            <div class="post">
                <h2><a href="/blog/hijacking-sudo-in-real-time.html">hijacking sudo in real time</a></h2>
                <h3>15 Aug 2018 22:03  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a></h3>
                
                  <pre>A while ago I posted about how sudo can be easily backdoored by dropping a fake
sudo script into the user&#x27;s PATH:

<a href="https://m4.rkw.io/blog/getting-root-without-an-exploit--stealth-sudo-backdoor.html">https://m4.rkw.io/blog/getting-root-without-an-exploit--stealth-sudo-backdoor...</a>

Another attack vector for sudo is monitoring the process list for invocations of
</pre>
                  <a href="/blog/hijacking-sudo-in-real-time.html" class="read-more">[read more...]</a>
                
            </div>
            
                            <div class="post">
                <h2><a href="/blog/cve201715358-local-root-privesc-in-charles-proxy-42.html">CVE-2017-15358 Local root privesc in Charles Proxy 4.2</a></h2>
                <h3>30 Jul 2018 06:41  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                
                  <pre>Charles Proxy is a great mac application for debugging web services and
inspecting SSL traffic for any application on your machine.

In order to inspect the SSL traffic it needs to configure the system to use a
proxy so that it can capture the packets and use its custom root CA to decode
the SSL.
</pre>
                  <a href="/blog/cve201715358-local-root-privesc-in-charles-proxy-42.html" class="read-more">[read more...]</a>
                
            </div>
            
                            <div class="post">
                <h2><a href="/blog/201617-macbook-pro-keyboard-recall.html">2016-17 Macbook Pro keyboard recall</a></h2>
                <h3>4 May 2018 07:38  | <a class="tag" href="/blog/tag/apple.html">apple</a></h3>
                
                  <pre>Somebody started a petition asking Apple to recall the 2016 (and presumably
2017 since they&#x27;re basically the same) macbook pros and fit them with a
keyboard &quot;that works&quot;:

<a href="https://www.change.org/p/apple-apple-recall-macbook-pro-w-defective-keyboard-replace-with-different-working-keyboard">https://www.change.org/p/apple-apple-recall-macbook-pro-w-defective-keyboard-...</a>

</pre>
                  <a href="/blog/201617-macbook-pro-keyboard-recall.html" class="read-more">[read more...]</a>
                
            </div>
            
                            <div class="post">
                <h2><a href="/blog/cve201716512-hashicorp-vagrantvmwarefusion-v502504-local-root.html">CVE-2017-16512 Hashicorp vagrant-vmware-fusion v5.0.2-5.0.4 local root</a></h2>
                <h3>28 Mar 2018 21:08  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                
                  <pre>Another Hashicorp bug that I&#x27;ve been sitting on since late last year. This one
was exploitable only during the vagrant update process, or even if the user
typed &quot;vagrant plugin update&quot; and there was no pending update.

It was possible for a rogue process on the system to subvert the upgrade process
in a way the user was unlikely to notice in order to steal root privileges.
</pre>
                  <a href="/blog/cve201716512-hashicorp-vagrantvmwarefusion-v502504-local-root.html" class="read-more">[read more...]</a>
                
            </div>
            
                            <div class="post">
                <h2><a href="/blog/cve201716839-hashicorp-vagrantvmwarefusion-v504-local-root.html">CVE-2017-16839 Hashicorp vagrant-vmware-fusion v5.0.4 local root</a></h2>
                <h3>28 Mar 2018 21:03  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                
                  <pre>Another exploit for the now deprecated vagrant-vmware-fusion plugin. This one
only works if VMware Fusion is not installed which is an unlikely scenario.
However if this should occur then it&#x27;s an easy root escalation so users should
still update.

<a href="https://m4.rkw.io/vagrant_vmware_privesc_5.0.4.sh.txt">https://m4.rkw.io/vagrant_vmware_privesc_5.0.4.sh.txt</a>
</pre>
                  <a href="/blog/cve201716839-hashicorp-vagrantvmwarefusion-v504-local-root.html" class="read-more">[read more...]</a>
                
            </div>
            
                            <div class="post">
                <h2><a href="/blog/cve201716873-hashicorp-vagrantvmwarefusion-v4025504-local-root.html">CVE-2017-16873 Hashicorp vagrant-vmware-fusion v4.0.25-5.0.4 local root</a></h2>
                <h3>28 Mar 2018 07:22  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                
                  <pre>This issue was reported to Hashicorp on 16/11/17. At first they claimed it was
low priority because it required local access, despite being a straight-to-root
escalation. Then they conceded that this wasn&#x27;t reasonable and said it was high
priority and that they would address it.

It has taken until this week to get their fixes out, involving an entire rewrite
</pre>
                  <a href="/blog/cve201716873-hashicorp-vagrantvmwarefusion-v4025504-local-root.html" class="read-more">[read more...]</a>
                
            </div>
            
                            <div class="post">
                <h2><a href="/blog/minotaur-fanotaur-and-excavataur.html">Minotaur, Fanotaur and Excavataur</a></h2>
                <h3>31 Jan 2018 08:53  | <a class="tag" href="/blog/tag/cryptocurrency.html">cryptocurrency</a> | <a class="tag" href="/blog/tag/mining.html">mining</a></h3>
                
                  <pre>I have released three cryptocurrency mining projects:

- Fanotaur: independently monitors Nvidia card temperatures and regulates fan
  speeds to keep them at a preset temperature.

- Minotaur: derives calibrated hashrates and power limits from your devices for
</pre>
                  <a href="/blog/minotaur-fanotaur-and-excavataur.html" class="read-more">[read more...]</a>
                
            </div>
            
                            <div class="post">
                <h2><a href="/blog/two-local-root-privesc-bugs-in-arq-backup--510.html">Two local root privesc bugs in Arq Backup <= 5.10</a></h2>
                <h3>29 Jan 2018 06:33  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                
                  <pre>Last year I found a couple more privilege escalation vectors in Arq Backup
for Mac version 5.10. Both have now been fixed in the latest release.

The first is relatively simple - the arq_updater binary (which runs as root)
takes a path argument for the url to retrieve an Arq update from in the format
Arq.zip. We can simply specify an arbitrary path - eg file:///tmp/blah/Arq.zip -
</pre>
                  <a href="/blog/two-local-root-privesc-bugs-in-arq-backup--510.html" class="read-more">[read more...]</a>
                
            </div>
            
            </div>
            <div id="right-content">
                
            <ul>
              <li>&nbsp;&nbsp;<a href="/blog.html">all posts</a>
            </ul>

            <ul>
              <li>&nbsp;&nbsp;[year]</li>
              
                <li>&nbsp;&nbsp;<a href="/blog/2022.html">2022</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/2021.html">2021</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/2020.html">2020</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/2019.html">2019</a></li>
              
                <li>&gt; <a href="/blog/2018.html">2018</a> &lt;</li>
              
                <li>&nbsp;&nbsp;<a href="/blog/2017.html">2017</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/2016.html">2016</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/2015.html">2015</a></li>
              
            </ul>

            <ul>
              <li>&nbsp;&nbsp;[tag]</li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/AWS.html">AWS</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/agile.html">agile</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/apple.html">apple</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/bash.html">bash</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/cryptocurrency.html">cryptocurrency</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/development.html">development</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/email.html">email</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/exploits.html">exploits</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/iOS.html">iOS</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/linux.html">linux</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/macOS.html">macOS</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/mining.html">mining</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/mysql.html">mysql</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/php.html">php</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/ruby.html">ruby</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/scrum.html">scrum</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/security.html">security</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/touchID.html">touchID</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/vim.html">vim</a></li>
              
                <li>&nbsp;&nbsp;<a href="/blog/tag/work.html">work</a></li>
              
            </ul>
            </div>
        </div>
				<script>
						(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
						(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
						m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
						})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

						ga('create', 'UA-91604161-1', 'auto');
						ga('send', 'pageview');
				</script>
    </body>
</html>
