<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
        <link rel="stylesheet" type="text/css" href="/css/style.css" />
        <link rel="alternate" type="application/rss+xml" title="m4.rkw.io blog" href="http://m4.rkw.io/blog/rss" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script src='https://www.google.com/recaptcha/api.js'></script>
        <script src="/js/site.js"></script>
        <title>Mark Wadham</title>
    </head>
    <body>
        <div id="menu">
                        <h3>Mark Wadham</h3>
            <ul>
                <li><a href="/index.html">profile</a></li>
                <li><a href="/blog.html">blog</a> <a href="/blog/rss"><img src="/img/rss.png" /></a></li>
                <li><a href="/cves.html">CVEs</a></li>
                <li><a href="/jsdemos.html">js demos</a></li>
                <li><a href="/contact.html">contact</a></li>
                <li class="space small">twitter: <a href="https://twitter.com/m4rkw">m4rkw</a></li>
                <li class="small">github: <a href="https://github.com/m4rkw">m4rkw</a></li>
                <li class="small">linkedin: <a href="https://uk.linkedin.com/in/mark-wadham-14ab49a6">379069834</a></li>
                <li class="red space small"></li>
            </ul>

        </div>
        <div id="content">
            <div id="main-content">
                                            <div class="post">
                <h2><a href="/blog/unlocking-ios-devices-with-a-yubikey.html">Unlocking iOS devices with a Yubikey</a></h2>
                <h3>8 Jul 2021 20:53  | <a class="tag" href="/blog/tag/apple.html">apple</a> | <a class="tag" href="/blog/tag/iOS.html">iOS</a></h3>
                  <pre>I love Yubikeys, they provide a very strong second factor for accounts and
services that you care a lot about. I use them for all kinds of things but one
thing I was quite excited to try was the Yubikey 5ci in static password mode.

On Yubikeys 5-series keys static password mode simply acts as a virtual
keyboard, playing back a static sequence of characters over the connected
interface (usually USB). I wasn&#39;t sure at first if this was supported over the
lightning port but it turns out it is which is very cool.

Using static password mode to supply the entire password for something is a bad
idea - if someone steals the key then they have the entire password and there&#39;s
no way to protect it on the key. Plug it in, press the sensor and voila you&#39;ve
got the entire secret string. But using it in combination with a known
passphrase is very powerful. I was quite excited about the idea of using this on
iOS - a relatively simple password combined with a huge amount of extra entropy
from the Yubikey as a salt.

If you&#39;re going to attempt this, DON&#39;T do what I did first and set the password
on the iPhone using the Yubikey. This is a really really bad idea - I did this
at first and although it appeared to work, the password set correctly, as soon
as I tried to unlock the phone by typing my passphrase and then activating the
Yubikey it didn&#39;t unlock. This was quite unnerving at the time but luckily I had
the secret string emitted by the key noted down and simply typing it in
carefully got me back into the phone. So learn from my mistake - type the
password into the iPhone very carefully rather than using the key to set it,
because if it just happens to fail in the same way twice in that moment you
might find yourself locked out of your device and facing the prospect of either
a lot of tedious guesswork (which and how many characters were dropped) or worse
- restoring from a backup.

The reason it failed to unlock was because the default output speed of the
Yubikey is too fast for an iPhone (it&#39;s a modern iPhone too - 12 Mini). I did
some testing and determined that I had to configure the maximum possible delay
of 60ms in the Yubikey Personalisation Tool before it would work semi-reliably.
Even with this extra delay it&#39;s not 100% but it works most of the time.

But now that it does it&#39;s really cool, as well as FaceID when that&#39;s active I
now have a much stronger password protecting the device when it&#39;s locked without
the huge inconvenience of typing a very long password into it manually.

There are a couple of downsides - you have to enable USB access on the lock
screen or else the key won&#39;t be able to talk to the phone in order to send the
keys. This seems like a reasonable trade-off for most people though - if you&#39;ve
got someone plugging hardware into your phone to try to break into it you&#39;ve
likely got much bigger things to worry about than me. To enable USB access go
to Settings -&gt; FaceID &amp; Passcode and make sure the &quot;USB Accessories&quot; checkbox
is enabled. The other downside is that the Apple leather case doesn&#39;t quite
have a big enough hole around the lightning socket for the key to insert, but
that&#39;s easily solved with a bit of sandpaper.

If you&#39;re going to attempt this make sure you backup the secret password
somewhere, I recommend storing it in an encrypted file and making several
backups, including at least one offline.</pre>
            </div>


            </div>
            <div id="right-content">
                
            <ul>
              <li>&nbsp;&nbsp;<a href="/blog.html">all posts</a>
            </ul>

            <ul>
              <li>&nbsp;&nbsp;[year]</li>
                <li>&gt; <a href="/blog/2021.html">2021</a> &lt;</li>
                <li>&nbsp;&nbsp;<a href="/blog/2020.html">2020</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/2019.html">2019</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/2018.html">2018</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/2017.html">2017</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/2016.html">2016</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/2015.html">2015</a></li>
            </ul>

            <ul>
              <li>&nbsp;&nbsp;[tag]</li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/AWS.html">AWS</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/agile.html">agile</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/apple.html">apple</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/bash.html">bash</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/cryptocurrency.html">cryptocurrency</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/development.html">development</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/exploits.html">exploits</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/iOS.html">iOS</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/linux.html">linux</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/macOS.html">macOS</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/mining.html">mining</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/mysql.html">mysql</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/php.html">php</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/ruby.html">ruby</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/scrum.html">scrum</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/security.html">security</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/touchID.html">touchID</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/vim.html">vim</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/work.html">work</a></li>
            </ul>

            </div>
        </div>
				<script>
						(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
						(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
						m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
						})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

						ga('create', 'UA-91604161-1', 'auto');
						ga('send', 'pageview');
				</script>
    </body>
</html>
