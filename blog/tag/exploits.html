<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
        <link rel="stylesheet" type="text/css" href="/css/style.css" />
        <link rel="alternate" type="application/rss+xml" title="m4.rkw.io blog" href="http://m4.rkw.io/blog/rss" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script src='https://www.google.com/recaptcha/api.js'></script>
        <script src="/js/site.js"></script>
        <title>Mark Wadham</title>
    </head>
    <body>
        <div id="menu">
                        <h3>Mark Wadham</h3>
            <ul>
                <li><a href="/index.html">profile</a></li>
                <li><a href="/blog.html">blog</a> <a href="/blog/rss"><img src="/img/rss.png" /></a></li>
                <li><a href="/cves.html">CVEs</a></li>
                <li><a href="/jsdemos.html">js demos</a></li>
                <li><a href="/contact.html">contact</a></li>
                <li class="space small">twitter: <a href="https://twitter.com/m4rkw">m4rkw</a></li>
                <li class="small">github: <a href="https://github.com/m4rkw">m4rkw</a></li>
                <li class="small">linkedin: <a href="https://uk.linkedin.com/in/mark-wadham-14ab49a6">379069834</a></li>
                <li class="red space small"></li>
            </ul>

        </div>
        <div id="content">
            <div id="main-content">
                                            <div class="post">
                <h2><a href="/blog/cve201715358-local-root-privesc-in-charles-proxy-42.html">CVE-2017-15358 Local root privesc in Charles Proxy 4.2</a></h2>
                <h3>30 Jul 2018 06:41  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>Charles Proxy is a great mac application for debugging web services and
inspecting SSL traffic for any application on your machine.

In order to inspect the SSL traffic it needs to configure the system to use a
proxy so that it can capture the packets and use its custom root CA to decode
the SSL.</pre>
                  <a href="/blog/cve201715358-local-root-privesc-in-charles-proxy-42.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/cve201716512-hashicorp-vagrantvmwarefusion-v502504-local-root.html">CVE-2017-16512 Hashicorp vagrant-vmware-fusion v5.0.2-5.0.4 local root</a></h2>
                <h3>28 Mar 2018 21:08  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>Another Hashicorp bug that I&#39;ve been sitting on since late last year. This one
was exploitable only during the vagrant update process, or even if the user
typed &quot;vagrant plugin update&quot; and there was no pending update.

It was possible for a rogue process on the system to subvert the upgrade process
in a way the user was unlikely to notice in order to steal root privileges.</pre>
                  <a href="/blog/cve201716512-hashicorp-vagrantvmwarefusion-v502504-local-root.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/cve201716839-hashicorp-vagrantvmwarefusion-v504-local-root.html">CVE-2017-16839 Hashicorp vagrant-vmware-fusion v5.0.4 local root</a></h2>
                <h3>28 Mar 2018 21:03  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>Another exploit for the now deprecated vagrant-vmware-fusion plugin. This one
only works if VMware Fusion is not installed which is an unlikely scenario.
However if this should occur then it&#39;s an easy root escalation so users should
still update.

<a href="https://m4.rkw.io/vagrant_vmware_privesc_5.0.4.sh.txt</pre">https://m4.rkw.io/vagrant_vmware_privesc_5.0.4.sh.txt</pre</a>>
                  <a href="/blog/cve201716839-hashicorp-vagrantvmwarefusion-v504-local-root.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/cve201716873-hashicorp-vagrantvmwarefusion-v4025504-local-root.html">CVE-2017-16873 Hashicorp vagrant-vmware-fusion v4.0.25-5.0.4 local root</a></h2>
                <h3>28 Mar 2018 07:22  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>This issue was reported to Hashicorp on 16/11/17. At first they claimed it was
low priority because it required local access, despite being a straight-to-root
escalation. Then they conceded that this wasn&#39;t reasonable and said it was high
priority and that they would address it.

It has taken until this week to get their fixes out, involving an entire rewrite</pre>
                  <a href="/blog/cve201716873-hashicorp-vagrantvmwarefusion-v4025504-local-root.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/two-local-root-privesc-bugs-in-arq-backup--510.html">Two local root privesc bugs in Arq Backup <= 5.10</a></h2>
                <h3>29 Jan 2018 06:33  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>Last year I found a couple more privilege escalation vectors in Arq Backup
for Mac version 5.10. Both have now been fixed in the latest release.

The first is relatively simple - the arq_updater binary (which runs as root)
takes a path argument for the url to retrieve an Arq update from in the format
Arq.zip. We can simply specify an arbitrary path - eg file:///tmp/blah/Arq.zip -</pre>
                  <a href="/blog/two-local-root-privesc-bugs-in-arq-backup--510.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/murus-firewall-1411-escalation-hihack--root-privesc.html">Murus Firewall 1.4.11 escalation hihack / root privesc</a></h2>
                <h3>4 Dec 2017 12:23  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>I recently blogged about the prevalence of escalation hijack vulnerabilities
amongst macOS applications. One example of this is the latest version of Murus
firewall. By design it requires the user to authenticate every time in order to
obtain the access it needs to modify the firewall settings.

If a local attacker or malware is running as an admin user (ie has write access</pre>
                  <a href="/blog/murus-firewall-1411-escalation-hihack--root-privesc.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/cve201716895-local-root-privesc-in-arq-backup--597.html">CVE-2017-16895 Local root privesc in Arq Backup <= 5.9.7</a></h2>
                <h3>29 Nov 2017 19:09  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>As well as the other bugs affecting Arq &lt;= 5.9.6 there is also another issue
with the suid-root restorer binaries in Arq for Mac. There are three of them
and they are used to execute restores of backed up files from the various
cloud providers.

After reversing the inter-app protocol I discovered that the path to the</pre>
                  <a href="/blog/cve201716895-local-root-privesc-in-arq-backup--597.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/cve201715357-local-root-privesc-in-arq-backup--596.html">CVE-2017-15357 Local root privesc in Arq Backup <= 5.9.6</a></h2>
                <h3>29 Nov 2017 19:02  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>Arq Backup from Haystack Software is a great application for backing up macs and
windows machines. Unfortunately versions of Arq for mac before 5.9.7 are
vulnerable to a local root privilege escalation exploit.

The updater binary has a &quot;setpermissions&quot; function which sets the suid bit and
root ownership on itself but it suffers from a race condition that allows you to</pre>
                  <a href="/blog/cve201715357-local-root-privesc-in-arq-backup--596.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/cve201716777-local-root-privesc-in-hashicorp-vagrantvmwarefusion-503.html">CVE-2017-16777 Local root privesc in Hashicorp vagrant-vmware-fusion 5.0.3</a></h2>
                <h3>15 Nov 2017 08:21  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>Another day, another root privesc bug in this plugin. Not quite so serious this
time - this one is only exploitable if the user has the plugin installed but
VMware Fusion *not* installed. This is a fairly unlikely scenario but it&#39;s a
straight to root privesc with no user interaction so isn&#39;t the kind of thing
that should be shipping with any software.
</pre>
                  <a href="/blog/cve201716777-local-root-privesc-in-hashicorp-vagrantvmwarefusion-503.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/cve201716001-local-root-privesc-in-hashicorp-vagrantvmwarefusion-501.html">CVE-2017-16001 Local root privesc in Hashicorp vagrant-vmware-fusion 5.0.1</a></h2>
                <h3>3 Nov 2017 08:21  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>I recently blogged about how the installation process of version 5.0.0 of this
plugin could be hihacked by a local attacker or malware in order to escalate
privileges to root.  Hashicorp pushed some mitigations for this issue fairly
quickly but unfortunately 5.0.1 is still exploitable with a slightly different
approach.
</pre>
                  <a href="/blog/cve201716001-local-root-privesc-in-hashicorp-vagrantvmwarefusion-501.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/cve201715918-sera-12-local-root-privesc-and-password-disclosure.html">CVE-2017-15918 Sera 1.2 local root privesc and password disclosure</a></h2>
                <h3>31 Oct 2017 08:20  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>Sera is a free app for mac and iOS that lets you unlock your mac automatically
when your iphone is within a configured proximity.

Unfortunately to facilitate this it stores the users login password in their
home directory at:
</pre>
                  <a href="/blog/cve201715918-sera-12-local-root-privesc-and-password-disclosure.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/cve201715884-local-root-privesc-in-hashicorp-vagrantvmwarefusion-500.html">CVE-2017-15884 Local root privesc in Hashicorp vagrant-vmware-fusion 5.0.0</a></h2>
                <h3>28 Oct 2017 12:32  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>After three CVEs and multiple exploits disclosed to Hashicorp they have finally
upped their game with this plugin. Now the previously vulnerable non-root-owned
ruby code that get executed as root by the sudo helper is no more and the sudo
helper itself is one static Go binary with tightly-controlled parameters that
can&#39;t (as far as I can tell) be exploited on its own.
</pre>
                  <a href="/blog/cve201715884-local-root-privesc-in-hashicorp-vagrantvmwarefusion-500.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/getting-root-without-an-exploit--stealth-sudo-backdoor.html">Getting root without an exploit - stealth sudo backdoor</a></h2>
                <h3>19 Oct 2017 21:59  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>I&#39;ve published several root privilege escalation bugs this year in various Mac
applications. I decided to see how difficult it would be to escalate privileges
on a machine without actually using an exploit. Having access to a local
account with sudo rights gives us an enormous attack surface for escalation.

Many of the dotfiles, which are nearly always user-writable for obvious reasons,</pre>
                  <a href="/blog/getting-root-without-an-exploit--stealth-sudo-backdoor.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/cve201712579-local-root-privesc-in-hashicorp-vagrantvmwarefusion-4024.html">CVE-2017-12579 Local root privesc in Hashicorp vagrant-vmware-fusion 4.0.24</a></h2>
                <h3>18 Oct 2017 08:11  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>I have previously disclosed a couple of bugs in Hashicorp&#39;s
vagrant-vmware-fusion plugin for vagrant.

Unfortunately the 4.0.23 release which was supposed to fix the previous bug I
reported didn&#39;t address the issue, so Hashicorp quickly put out another release
- 4.0.24 - after that (but didn&#39;t update the public changelog on github).</pre>
                  <a href="/blog/cve201712579-local-root-privesc-in-hashicorp-vagrantvmwarefusion-4024.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/cve201711741-local-root-privesc-in-hashicorp-vagrantvmwarefusion--4023.html">CVE-2017-11741 Local root privesc in Hashicorp vagrant-vmware-fusion <= 4.0.23</a></h2>
                <h3>2 Aug 2017 06:49  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>A couple of weeks ago I disclosed a local root privesc in Hashicorp&#39;s
vagrant-vmware-fusion plugin:

<a href="https://m4.rkw.io/blog/cve20177642-local-root-privesc-in-hashicorp-vagrantvmwarefusion--4020.html">https://m4.rkw.io/blog/cve20177642-local-root-privesc-in-hashicorp-vagrantvmw...</a>

The initial patch they released was 4.0.21 which unfortunately contained a bug</pre>
                  <a href="/blog/cve201711741-local-root-privesc-in-hashicorp-vagrantvmwarefusion--4023.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/cve20177642-local-root-privesc-in-hashicorp-vagrantvmwarefusion--4020.html">CVE-2017-7642 Local root privesc in Hashicorp vagrant-vmware-fusion <= 4.0.20</a></h2>
                <h3>15 Jul 2017 06:57  | <a class="tag" href="/blog/tag/macOS.html">macOS</a> | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a></h3>
                  <pre>I&#39;m a big fan of Hashicorp but this is an awful bug to have in software of their
calibre.

Their vagrant plugin for vmware fusion uses a product called Ruby Encoder to
protect their proprietary ruby code.  It does this by turning the ruby code into
bytecode and executing it directly.</pre>
                  <a href="/blog/cve20177642-local-root-privesc-in-hashicorp-vagrantvmwarefusion--4020.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/sudolikeaboss-allows-password-theft.html">sudolikeaboss allows password theft</a></h2>
                <h3>3 May 2017 13:12  | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a> | <a class="tag" href="/blog/tag/macOS.html">macOS</a></h3>
                  <pre>sudolikeaboss is a neat little program that acts as a command-line interface to
1Password Pro, effectively giving you a way to use 1password with the terminal.

This is useful but it does come with a security tradeoff as any application
running in the context of the user can potentially steal passwords if 1password
is in an unlocked state.</pre>
                  <a href="/blog/sudolikeaboss-allows-password-theft.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/cve20177690-local-root-privesc-in-proxifier-for-mac-219.html">CVE-2017-7690 Local root privesc in Proxifier for Mac 2.19</a></h2>
                <h3>11 Apr 2017 20:57  | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a> | <a class="tag" href="/blog/tag/macOS.html">macOS</a></h3>
                  <pre>With CVE-2017-7643 I disclosed a command injection vulnerablity in the KLoader
binary that ships with Proxifier &lt;= 2.18.

Unfortunately 2.19 is also vulnerable to a slightly different attack that
yields the same result.
</pre>
                  <a href="/blog/cve20177690-local-root-privesc-in-proxifier-for-mac-219.html" class="read-more">[read more...]</a>
            </div>

                            <div class="post">
                <h2><a href="/blog/cve20177643-local-root-privesc-in-proxifier-for-mac--218.html">CVE-2017-7643 Local root privesc in Proxifier for Mac <= 2.18</a></h2>
                <h3>10 Apr 2017 21:19  | <a class="tag" href="/blog/tag/security.html">security</a> | <a class="tag" href="/blog/tag/exploits.html">exploits</a> | <a class="tag" href="/blog/tag/macOS.html">macOS</a></h3>
                  <pre>Proxifier 2.18 (also 2.17 and possibly some earlier version) ships with a
KLoader binary which it installs suid root the first time Proxifier is run. This
binary serves a single purpose which is to load and unload Proxifier&#39;s kernel
extension.

Unfortunately it does this by taking the first parameter passed to it on the</pre>
                  <a href="/blog/cve20177643-local-root-privesc-in-proxifier-for-mac--218.html" class="read-more">[read more...]</a>
            </div>


            </div>
            <div id="right-content">
                
            <ul>
              <li>&nbsp;&nbsp;<a href="/blog.html">all posts</a>
            </ul>

            <ul>
              <li>&nbsp;&nbsp;[year]</li>
                <li>&nbsp;&nbsp;<a href="/blog/2020.html">2020</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/2019.html">2019</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/2018.html">2018</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/2017.html">2017</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/2016.html">2016</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/2015.html">2015</a></li>
            </ul>

            <ul>
              <li>&nbsp;&nbsp;[tag]</li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/AWS.html">AWS</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/agile.html">agile</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/apple.html">apple</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/bash.html">bash</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/cryptocurrency.html">cryptocurrency</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/development.html">development</a></li>
                <li>&gt; <a href="/blog/tag/exploits.html">exploits</a> &lt;</li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/iOS.html">iOS</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/linux.html">linux</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/macOS.html">macOS</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/mining.html">mining</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/mysql.html">mysql</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/php.html">php</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/ruby.html">ruby</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/scrum.html">scrum</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/security.html">security</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/touchID.html">touchID</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/vim.html">vim</a></li>
                <li>&nbsp;&nbsp;<a href="/blog/tag/work.html">work</a></li>
            </ul>

            </div>
        </div>
				<script>
						(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
						(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
						m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
						})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

						ga('create', 'UA-91604161-1', 'auto');
						ga('send', 'pageview');
				</script>
    </body>
</html>
